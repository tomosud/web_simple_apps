# 音ゲー（otoge）

---
# 🎮 プレイ方法

https://tomosud.github.io/web_simple_apps/otoge/

↑を開いて。

# 🎮 ゲームプレイヤー向け情報

## ゲーム概要

**「お金を使えば使うほど、人間が大きくなる。今月もがんばろう！」**

東京で生きる普通のサラリーマンの日常を音楽ゲームで体験する作品です。朝7時30分の改札から始まる一日、コンビニでの小さな買い物、電車の往復、母親からの温かい振込——日々の消費行動の中にある、愛と孤独と希望を描いた現代的な音楽体験です。

### 🎵 音楽と歌詞について

ステージ3から流れる楽曲「7:30 through the ticket gate」は、東京で働く人々の心の声を歌ったオリジナル楽曲。レシートに刻まれる数字の向こう側にある本当の感情を歌詞に込めました。改札を通る音、コンビニの明かり、通知音——現代都市生活のサウンドスケープと共に、一人の人間の物語が展開されます。

### 🎮 ゲームシステム

#### 基本システム
- **初期資金**: 30,000円（今月の生活費）
- **4レーン制**: PayPay、Suica、ファミリーマート、LINEでの消費体験
- **リアルな価格**: 実際の商品価格データによる本格的な支出シミュレーション
- **ライフシステム**: 4つのハート。生活の厳しさを表現
- **ステージ制**: 30秒ごとに進む「X日目」のサイクル

#### 操作方法
- **タップ**: ブランドロゴが判定ラインに来たタイミングでタップ
- **成功**: リアルな決済音と共に、商品価格が生活費から差し引かれる
- **失敗**: ライフが減少。生活の厳しさを実感

#### 特別演出
- **ステージ3**: 「AIが歌います。」— 音楽と歌詞字幕が始まる特別な瞬間
- **歌詞字幕**: 楽曲に込められた想いを、リアルタイムで体験

### 🌆 テーマ性

この作品は、現代の都市生活者が抱える普遍的な体験を音楽ゲームに落とし込んだものです。

- **消費と愛情**: お金の取引の向こう側にある、人とのつながり
- **都市の孤独**: 800万人が住む東京で、一人でいることの意味
- **日常の詩情**: コンビニ弁当や電車賃にも宿る、小さなドラマ
- **母親の愛**: 振込通知に込められた、変わらない愛情
- **存在証明**: レシートという記録に刻まれた、「僕がここにいた」証拠

---

# 🛠️ 実装の経緯

## プロジェクト背景

### 開発手法: 100% AIコーディング
このプロジェクトは、人間のディレクションとAIの協働による100%AIコーディングで実現されました。

- **コーディング**: Claude（Anthropic）が全コードを生成
- **ディレクション**: 人間が仕様策定・品質管理・デザイン判断
- **開発時間**: 約10時間（企画から完成まで）

### データ作成プロセス
- **商品価格データ**: 人間とLLMの協働でCSVデータ生成
- **フレーバーテキスト**: AIが量産、人間が選択・調整
- **音楽制作**: 歌詞を人間とLLMで共作 → Sunoで楽曲生成（https://suno.com/）
- **字幕データ**: WebVTT形式で楽曲と完全同期

## 技術仕様

### アーキテクチャ
- **3Dエンジン**: Three.js r128による本格的な3D音楽ゲーム
- **音響システム**: Web Audio API + HTML5 Audio のハイブリッド構成
- **データ駆動**: CSV形式による価格データの動的読み込み
- **入力処理**: 3D座標投影による精密なタッチ判定
- **レスポンシブ**: PC・スマートフォン完全対応

### ファイル構成
```
otoge/
├── index.html              # メインHTML
├── css/
│   └── style.css          # レスポンシブスタイル
├── js/
│   ├── main.js            # ゲーム初期化・メインループ (98行)
│   ├── scene.js           # Three.js 3Dシーン・テクスチャ管理 (387行)
│   ├── gameLogic.js       # ゲームロジック・UI更新・AI歌唱制御 (399行)
│   ├── costManager.js     # CSV価格データ管理・ランダム選択 (248行)
│   ├── inputHandler.js    # 3D座標投影による精密入力処理 (356行)
│   ├── soundManager.js    # Web Audio API・音楽再生管理 (387行)
│   └── subtitleManager.js # WebVTT字幕表示システム (394行)
├── assets/
│   ├── cost/              # 価格データ（CSV）
│   │   ├── config.json    # ブランド別選択ルール
│   │   ├── famima.csv     # ファミリーマート商品価格（95件）
│   │   ├── line.csv       # LINE関連サービス価格
│   │   ├── peypey.csv     # PayPay決済商品価格
│   │   └── suica.csv      # Suica決済商品価格
│   ├── textures/          # テクスチャファイル
│   │   ├── famima.png     # ファミリーマートロゴ（128x128）
│   │   ├── line.png       # LINEロゴ（128x128）
│   │   ├── peypey.png     # PayPayロゴ（128x128）
│   │   ├── suica.png      # Suicaロゴ（128x128）
│   │   └── grad.png       # グラデーションテクスチャ
│   ├── music/             # 音楽ファイル
│   │   └── 7_30 through the ticket gateB.mp3  # Suno生成楽曲
│   ├── vtt/               # 字幕ファイル
│   │   └── 7_30 through the ticket gateB.vtt  # 歌詞字幕データ
│   └── sounds/            # ブランド別効果音
└── run.bat               # ローカルサーバー起動バッチ
```



# 開発の流れMEMO

AIコーディングの発展の現状に浴する目的で、公開とかはしない1アイデアのゲームを作り続けている。  
久しぶりに、趣味っぽい。だいたいいつも。金曜日、帰宅後から初めて、寝るまでに終わってることを目指す。

## ■金曜の夜　多分5～6時間？

### ・アイデア  
PayPay/Suica等、実在のペイメント関連のブランドをモチーフにするアイデアを思いついた  
まずは単にこういう音がなると面白いだろうくらいの事

### ・ゲームの実装

#### --開始の仕様書  
音が鳴ると面白い→だったら音ゲーだろくらいの考えから開始。  
codeingはclaude codeで行うけど、最初はclaude desktopからMCPを通じて、指示書を作ってもらう。  
claude desktopは画像を見ることができるので、いくつかのゲームの画像からやり取りして仕様を作る。  
claude codeがMCPで操作されるけど、操作のたびに記憶を失ってるようなので、ここではコーディングはしない。  
以下のように、画像を見てレビュー→指示は、たびたび、claude desktopから。  
https://claude.ai/share/e8893628-424d-4d17-b9d7-89384a14b7d7

そんなに複雑なコード群にはならなそうなので、ドキュメントは以下の二つ。  
README.md(ゲームの仕様とか結果)  
PLAN.md(開発文書)

#### --開発と開発中の指示  
上記の文書をもとに、Claude Codeで開発を。  
2025/6月の現時点で、毎日のように新しいAIのサービスや、コーディングのツールが発表されている。  
数日前にはGemini CLIが発表された。  
Claude Codeとそれ以外の方法の差は、たぶんわずかなんだろうけど、そのわずかの部分が大きな差を産んでいると思って今は使っている。

ほぼ、一発で、指示通りの音ゲーの基礎が、Three.jsで実装された。  
ここまでだと１５分くらい？  
ここからは、Claude Codeに指示をだし、自身でmdを更新させながら、改善の実装を。

#### 改善の例  
最初は、演出を行わずに、基礎のゲーム部分を更新し続ける。  
ロゴのアイコンを目立たせたいので、５レーンだと小さくなりすぎる。  
4レーンに減らしたり・・・。  
この時点では音はシステムで鳴らしている。

以降、以下のフレーバーのためのデータを作成しながら順番に実装していく。

### ・データの作成

ブランドアイコンと、サウンド。

当初、Gemini CLIに用意させることを考えていた。pythonによる仮想環境と技術の指示を作成しかけたけど以下の点で結構面倒そうなので、手動で終わらせた。

・現状のロゴの画像を集めてきて、ちょうどいいレイアウトで切り取る  
・サウンド素材をを集めてきて、ちょうどいいレイアウトで切り取る

どっちも、どれが最新で品質が高くて、ちょうどよい切り取りか？が難しいので・・。  
このくらいの個数だと実装が見合わない。

一方、無作為の多くの画像を集めたりするのは得意なのだが、今回はそうではないので、AIコーディングの待ちの間にどんどん手で作って置いた。

### ・フレーバーテキスト

レーンを各ブランドのロゴが降りてくる。これを手前のエリアでタイミングよく押すとOK.押せないとミス。  
押せた場合に、ペイメントした商品が具体的に表示できると面白いと思いついて、以下のようなデータを作成した。

以下のようなテーマで、リアリティのある、商品?名と価格のペアを。csvで。

PayPay レストランとか  
Suica 交通費　駅で買いそうなものを中心  
Famima コンビニで買いそうな複数商品  
Line　居酒屋とかで注文のために登録した名残のDM　たまに母から仕送り

このデータは、chatGPT　4oと作成した。現実に即した物への理解度が高いと考えているので。  
https://chatgpt.com/share/68613367-8f94-8001-adc3-d08e913b468e

当初、やや無作為で抽象的な「パン,120」みたいな感じになってしまったので、以下のようにテーマを与え、内容をリアリティのあるものにしていった。  
・都内で、独身で、東京駅周辺で働く、西荻に住んでいる独身の・・・」  
商品名は例を与え、検索しながら作ってもらうなど。データの割合や、内容は割と具体的に例を。

### ・音楽作成

最後の方で、思いついて実装を。

当初、ぼんやり考えていたアイデアは、  
・聞きなれたブランドロゴで、ビートに合わせたら意外と音楽みたいに聞こえて面白い  
みたいな感じだったと思うが、実際作って、フレーバーテキストを入れてみると、  
・都会の生活の中で、消費し続けてることと、その時聞いてる音が、延々と繰り返されるエモさ  
が割と前面に出てきたので、ゲーム性よりそれを強調するのが良いように思えてきた。

最近、音楽制作のsunoを試していたので、ボーカルのはいった音楽の追加を思いつき以下のように実装した。

フレーバーテキストのやり取りをしていたChatGPTのチャットで、そのままの流れで基礎を作成。  
その後、ClaudeCodeで、一部の歌詞を英語化したリ、して完成。文章としてのエモさはClaudeCodeの方が上と思ってるのでそうしたけど、今見ると、ChatGPTの方でほぼ完成していた。

sunoで、お試しが終わるまで曲をパターン出し。ちょっと読み間違えてるのを修正しながら、以下のように修正しながら進めたが、結局読み違いの多い２曲目が良くて採用。

・1000円→千円　と書かないと色んな読み方しちゃう　ワンサウザントイェンとそうでないのとか

課金すると違うかもしれないけど、この曲の歌詞だけ修正とかできなくて毎回違うのが出てくるのかな？

ステージ3から鳴るように、実装。  
途中からにしたのは、きっとびっくりすると思ったので。

### ・成果  
ゲーム要素ほぼ完成。夜中2時か3時くらいだった。

---

## ■土曜　夕方から多分5～6時間？

### ・字幕システムの実装

歌うのは面白いんだけど、何が起こったのかわからなくなりそうなのと、エモい（けど聞き取りにくい）歌詞を把握してもらいたかったので字幕を実装。  
と言っても、sunoのサービスからは字幕ファイルは書き出せなかったので、まずデータの自作を。

当初wisperでの音声解析から字幕vttファイルを書き出す仕組みの実装を目指した。  
以前、google colabで作ったことはあったので、簡単なはずだけど、claude desktopが大きめのmodelデータのDLに失敗するので、独自実装は中止。  
調べたらオンラインのサービスで可能だったので、mp3→字幕vttファイルを作成。

わかってたことだけど、曲入りの歌、且つ日英混じった歌唱なので、タイミングはあってるけど、聞き取り内容がかなり間違ってるので以下のように修正した。

claudeのチャットで、vttファイルと元の歌詞のテキストを渡し、適当に合わせてもらった。ほぼ問題なく修正できた。

ゲーム側で、vttファイルから字幕の表示の機能実装。  
独自のパーサーも含め、一旦表示はすぐできた。ただ、この後いくつかの文字をどうしても表示できない問題に数時間はまる。

主に、複雑すぎるパーサーの実装と、vttファイルのタイムコードのギャップ？の問題で、それぞれ修正して解決。

### ・スマホでの画角など調整

PC画面でのチェックは容易だが、スマホはデータをUPしないと見れないので、チェック頻度が低く。  
縦構図になった場合の構図がや良くなかったり・・。  
文字が小さかったり・・。

以下の様に実装を変えていった  
この辺はclaude desktopで画像を見せて指示　具体的な値で指示を  
PCのブラウザを縦構図にして、claude codeにカメラ角度などさらに細かく指示  
文字は、スケーラブルに計算して実装するように指示。

### ・成果

---

## ■日曜　多分1時間？

### ・微調整  
もうほぼやることない

### ・成果  
完成


---

**現在のステータス**: **完成** - 全機能実装完了、安定動作確認済み
